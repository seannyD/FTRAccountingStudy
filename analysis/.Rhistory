begin = 'There was a significant'
}
if(returnText){
return(paste(begin,ef,"(",wald.text,"log likelihood difference =",
loglikDiff,", df = ",df,", Chi Squared =", chi,", p = ",p,")."))
} else{
return(c(est,loglikDiff,df,chi,p))
}
}
```
# Introduction
Test the relationship between strong/weak FTR and AAM, with and without controls for language family.
# Load libraries
```{r warning=F,message=F}
library(lme4)
library(sjPlot)
library(REEMtree)
library(rpart)
library(rpart.plot)
library(MASS)
library(ggplot2)
library(RColorBrewer)
library(MCMCglmm)
library(ape)
library(caper)
```
# Load data
```{r}
d = read.csv("../data/clean/data.csv",
fileEncoding = "utf-8",
encoding = 'utf-8')
dIE = d[d$mainLanguageFamily=="Indo-European",]
dIE$DPlaceLang =
countryMainLanguageFamily[
match(as.character(dIE$loc),
countryMainLanguageFamily$Country.Code),
]$DPlaceLang
countryMainLanguageFamily =
read.csv("../data/raw/CountryMainLanguageToLanguageFamily.csv",
stringsAsFactors = F)
tree = read.nexus(file = "../data/raw/trees/bouckaert_et_al2012-d-place_2.NEXUS")
dplaceLangs = countryMainLanguageFamily$DPlaceLang[countryMainLanguageFamily$DPlaceLang!=""]
tree = drop.tip(tree,tree$tip.label[!tree$tip.label %in% dplaceLangs])
treePrint = tree
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
treePrint = ladderize(treePrint)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 100)
treePrint
treePrint$tip.label
countryMainLanguageFamily$FTR
countryMainLanguageFamily[match(treePrint$tip.label,countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label
countryMainLanguageFamily$DPlaceLang
countryMainLanguageFamily
countryMainLanguageFamily[match(treePrint$tip.label,countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label
treePrint = tree
treePrint$tip.label
countryMainLanguageFamily[match(treePrint$tip.label,countryMainLanguageFamily$DPlaceLang),]$FTR
countryMainLanguageFamily[match(treePrint$tip.label,countryMainLanguageFamily$DPlaceLang),]$FTR
lx = read.csv("../data/raw/langftr.csv",stringsAsFactors = F)
countryMainLanguageFamily[countryMainLanguageFamily$FTR=="",]$FTR =
c("Weak","Strong")[lx[match(countryMainLanguageFamily[countryMainLanguageFamily$FTR=="",]$Country.Code,
lx$loc),]$strongftr+1]
countryMainLanguageFamily[match(treePrint$tip.label,countryMainLanguageFamily$DPlaceLang),]$FTR
treeFTR = countryMainLanguageFamily[
match(treePrint$tip.label,
countryMainLanguageFamily$DPlaceLang),]$FTR
1+as.factor(treeFTR)
as.factor(treeFTR)
countryMainLanguageFamily[match(treePrint$tip.label,countryMainLanguageFamily$DPlaceLang),]$FTR
pcols = c(brewer.pal(n = 8,name = "Set2"),"#FFFFFF")
treePrint = tree
treeFTR = countryMainLanguageFamily[
match(treePrint$tip.label,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
treePrint = ladderize(treePrint)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 100)
axisPhylo(xpd=T)
tiplabels(pch = 19,
col = pcols[1+as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
names(countryMainLanguageFamily)
countryMainLanguageFamily[,c("DPlaceLang","FTR")]
treePrint = tree
treePrint = ladderize(treePrint)
treeFTR = countryMainLanguageFamily[
match(treePrint$tip.label,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 100)
axisPhylo(xpd=T)
tiplabels(pch = 19,
col = pcols[1+as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
treePrint$tip.label
treePrint$tip.label
pcols = c(brewer.pal(n = 8,name = "Set2"),"#FFFFFF")
treePrint = tree
treePrint = ladderize(treePrint)
is_tip <- tree2$edge[,2] <= length(tree2$tip.label)
ordered_tips <- tree2$edge[is_tip, 2]
ordered_tip_labels <- tree2$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
#pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 100)
axisPhylo(xpd=T)
tiplabels(pch = 19,
col = pcols[1+as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
pcols = c(brewer.pal(n = 8,name = "Set2"),"#FFFFFF")
treePrint = tree
treePrint = ladderize(treePrint)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
#pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 100)
axisPhylo(xpd=T)
tiplabels(pch = 19,
col = pcols[1+as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
#dev.off()
countryMainLanguageFamily[,c("DPlaceLang","FTR")]
pcols = c(brewer.pal(n = 8,name = "Set2"),"#FFFFFF")
treePrint = tree
treePrint = ladderize(treePrint)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
#pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 100)
axisPhylo(xpd=T)
tiplabels(pch = c(19,20)[1+as.numeric(as.factor(treeFTR))],
col = pcols[1+as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
plot(1:20,pch=1:20)
pcols = c(brewer.pal(n = 8,name = "Set2"),"#FFFFFF")
treePrint = tree
treePrint = ladderize(treePrint)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
#pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 100)
axisPhylo(xpd=T)
tiplabels(pch = c(16,17)[1+as.numeric(as.factor(treeFTR))],
col = pcols[1+as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
pcols = c(brewer.pal(n = 8,name = "Set2"),"#FFFFFF")
treePrint = tree
treePrint = ladderize(treePrint)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
#pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 100)
axisPhylo(xpd=T)
tiplabels(pch = c(19,17)[1+as.numeric(as.factor(treeFTR))],
col = pcols[1+as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
#dev.off()
c(19,17)[1+as.numeric(as.factor(treeFTR))]
1+as.numeric(as.factor(treeFTR))
pcols = c(brewer.pal(n = 8,name = "Set2"),"#FFFFFF")
treePrint = tree
treePrint = ladderize(treePrint)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
#pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 100)
axisPhylo(xpd=T)
tiplabels(pch = c(19,17)[as.numeric(as.factor(treeFTR))],
col = pcols[as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
#dev.off()
countryMainLanguageFamily[,c("DPlaceLang","FTR")]
pcols = c(brewer.pal(n = 8,name = "Set2"),"#FFFFFF")[2:1]
treePrint = tree
treePrint = ladderize(treePrint)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
#pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 100)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR))],
col = pcols[as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
#dev.off()
countryMainLanguageFamily[,c("DPlaceLang","FTR")]
pcols = c("black","gray")
treePrint = tree
treePrint = ladderize(treePrint)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
#pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 100)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR))],
col = pcols[as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 100)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR))],
col = pcols[as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
dev.off()
pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 120)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR))],
col = pcols[as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
dev.off()
pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 150)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR))],
col = pcols[as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
dev.off()
tiplabels()
nodelabels()
?rotate
pcols = c("black","gray")
treePrint = tree
treePrint = ladderize(treePrint)
treePrint = rotate(treePrint,28)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 150)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR))],
col = pcols[as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
dev.off()
countryMainLanguageFamily[,c("DPlaceLang","FTR")]
countryMainLanguageFamily[countryMainLanguageFamily$FTR=="Weak",]$Country.Name
countryMainLanguageFamily[countryMainLanguageFamily$FTR=="Weak",]$DPlaceLang
treePrint
pcols = c("black","gray")
treePrint = tree
treePrint = ladderize(treePrint)
treePrint = rotate(treePrint,28)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 150)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR))],
col = pcols[as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
dev.off()
pcols = c("black","gray")
treePrint = tree
treePrint = ladderize(treePrint)
#treePrint = rotate(treePrint,28)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 150)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR))],
col = pcols[as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
dev.off()
countryMainLanguageFamily[countryMainLanguageFamily$FTR=="Weak",]$DPlaceLang
ordered_tip_labels
plot(treePrint)
countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$DPlaceLang
pcols = c("black","gray")
treePrint = tree
treePrint = ladderize(treePrint)
#treePrint = rotate(treePrint,28)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 150)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR))],
col = pcols[as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
dev.off()
treeFTR
names(treeFTR) = ordered_tip_labels
treeFTR
pcols[as.numeric(as.factor(treeFTR))]
tiplabels(text=names(treeFTR))
plot(treePring)
plot(treePrint)
tiplabels()
treePrint$tip.label
pcols = c("black","gray")
treePrint = tree
treePrint = ladderize(treePrint)
#treePrint = rotate(treePrint,28)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
names(treeFTR) = ordered_tip_labels
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 150)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR[treePrint$tip.label]))],
col = pcols[as.numeric(as.factor(treeFTR[treePrint$tip.label]))],
adj = 2.5, cex = 2)
tiplabels(text=names(treeFTR))
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
dev.off()
pcols = c("black","gray")
treePrint = tree
treePrint = ladderize(treePrint)
#treePrint = rotate(treePrint,28)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(ordered_tip_labels,
countryMainLanguageFamily$DPlaceLang),]$FTR
names(treeFTR) = ordered_tip_labels
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 150)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR[treePrint$tip.label]))],
col = pcols[as.numeric(as.factor(treeFTR[treePrint$tip.label]))],
adj = 2.5, cex = 2)
#tiplabels(text=names(treeFTR))
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
dev.off()
treeFTR[treePrint$tip.label]
ordered_tip_labels
```{r echo=F}
pcols = c("black","gray")
treePrint = tree
treePrint = ladderize(treePrint)
#treePrint = rotate(treePrint,28)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(treePrint$tip.label,
countryMainLanguageFamily$DPlaceLang),]$FTR
names(treeFTR) = ordered_tip_labels
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 150)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR))],
col = pcols[as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
tiplabels(text=names(treeFTR))
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
dev.off()
pcols = c("black","gray")
treePrint = tree
treePrint = ladderize(treePrint)
#treePrint = rotate(treePrint,28)
is_tip <- treePrint$edge[,2] <= length(treePrint$tip.label)
ordered_tips <- treePrint$edge[is_tip, 2]
ordered_tip_labels <- treePrint$tip.label[ordered_tips]
treeFTR = countryMainLanguageFamily[
match(treePrint$tip.label,
countryMainLanguageFamily$DPlaceLang),]$FTR
names(treeFTR) = ordered_tip_labels
treePrint$tip.label= gsub("_ST","",treePrint$tip.label)
treePrint$tip.label= gsub("_Mod","",treePrint$tip.label)
treePrint$tip.label= gsub("_List","",treePrint$tip.label)
pdf("../results/tree.pdf", width=7, height=5.5)
ape::plot.phylo(treePrint,root.edge = T,edge.width=8,label.offset = 150)
axisPhylo(xpd=T)
tiplabels(pch = c(17,19)[as.numeric(as.factor(treeFTR))],
col = pcols[as.numeric(as.factor(treeFTR))],
adj = 2.5, cex = 2)
#tiplabels(text=names(treeFTR))
text(3000,-3.5,"Years before present",xpd=T)
lines(c(-200,0),c(15.5,15.5),lwd=8)
dev.off()
countryMainLanguageFamily[countryMainLanguageFamily$FTR=="Weak",]$DPlaceLang
unique(countryMainLanguageFamily[countryMainLanguageFamily$FTR=="Weak",]$DPlaceLang)
