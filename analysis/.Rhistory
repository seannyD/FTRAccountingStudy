test("~~~~~")
test("abcba")
test("1")
test(" ")
test("~")
test(" ~")
test("~ ")
test("  0")
test("!@#$%^&*()ABCDEFGhijklmnop1234567890")
test(" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~")
sQuote("‘")
sQuote("‘")
sQuote("’")
?nchar
formatC(pi)
letters
grepl("^X",s)
grepl("^X",s)+1
s
x = function(s){
#sub(".",c("X","Y")[grepl("^X",s)+1],s)
sub(".",letters[grepl("^X",s)+1],s)
}
letters[1:2]
x = function(s){
#sub(".",c("X","Y")[grepl("^X",s)+1],s)
sub(".",letters[grepl("^a",s)+1],s)
}
test("X")
test("a")
test("b")
test("ab")
test("ba")
test("'")
test("'\"")
test("\\\\")
test('"')
test('""')
test('‘')
test('’')
test("XX")
test("YX")
test("~")
test("asdf")
test("1111")
test("       ")
test("~~~~~")
test("abcba")
test("1")
test(" ")
test("~")
test(" ~")
test("~ ")
test("  0")
test("!@#$%^&*()ABCDEFGhijklmnop1234567890")
test(" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~")
x = function(s){
#sub(".",c("X","Y")[grepl("^X",s)+1],s)
sub(".",letters[grepl("^a",s)+1],s)
}
# `letters` is constant and a slightly shorter way of doing `c("a","b")`
substring(sQuote(s),2)
substring(shQuote(s),3)
x = function(s){
#substr(shQuote(s),1,nchar(s))
substr(shQuote(s),1,nchar(s))
}
test = function(t){
t2 = x(t)
t2!=t & nchar(t)==nchar(t2)
}
# Because the string might have multiple escaped characters, we need to take a substring of the correct length
# `sQuote` is shorter, but converts "‘" to "‘‘’"
test("X")
test("a")
test("b")
test("ab")
test("ba")
test("'")
test("'\"")
test("\\\\")
test('"')
test('""')
test('‘')
test('’')
test("XX")
test("YX")
test("~")
test("asdf")
test("1111")
test("       ")
test("~~~~~")
test("abcba")
test("1")
test(" ")
test("~")
test(" ~")
test("~ ")
test("  0")
test("!@#$%^&*()ABCDEFGhijklmnop1234567890")
test(" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~")
shQuote("'")
testStrings = c("X","a","b","ab","ba",
"'","'\"","\\\\",'"','""',
'‘','’',"XX","YX","~","asdf",
"1111","       ","~~~~~","abcba",
"1"," ","~"," ~","~ ","  0",
"!@#$%^&*()ABCDEFGhijklmnop1234567890",
" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~")
sapply(testStrings,test)
testStrings = c("X","a","b","ab","ba",
"'","'\"","\\\\",'"','""',
'‘','’',"XX","YX","~","asdf",
"1111","       ","~~~~~","abcba",
"1"," ","~"," ~","~ ","  0",
"!@#$%^&*()ABCDEFGhijklmnop1234567890",
" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~")
all(sapply(testStrings,test))
rm(list=ls())
x = function(s){
substr(shQuote(s),1,nchar(s))
}
test = function(t){
t2 = x(t)
t2!=t & nchar(t)==nchar(t2)
}
testStrings = c("X","a","b","ab","ba",
"'","'\"","\\\\",'"','""',
'‘','’',"XX","YX","~","asdf",
"1111","       ","~~~~~","abcba",
"1"," ","~"," ~","~ ","  0",
"!@#$%^&*()ABCDEFGhijklmnop1234567890",
" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~")
all(sapply(testStrings,test))
testStrings = c("a","b","ab","ba","aa",
"'","'\"","\\\\",'"','""',
'‘','’',"~","asdf",
"1111","       ","~~~~~","abcba",
"1"," ","~"," ~","~ ","  0",
"!@#$%^&*()ABCDEFGhijklmnop1234567890",
" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~")
all(sapply(testStrings,test))
T+"F"
T+1
strsplit(s)
s="abcd"
letters[strsplit(s)=="a"]
letters[strsplit(s,'')=="a"]
strsplit(s,'')
letters[strsplit(s,'')[[1]]=="a"]
letters[el(strsplit(s,''))=="a"]
?readLines
?function
??function
x = function(s)substr(shQuote(s),1,nchar(s))
test = function(t){
t2 = x(t)
t2!=t & nchar(t)==nchar(t2)
}
testStrings = c("a","b","ab","ba","aa",
"'","'\"","\\\\",'"','""',
'‘','’',"~","asdf",
"1111","       ","~~~~~","abcba",
"1"," ","~"," ~","~ ","  0",
"!@#$%^&*()ABCDEFGhijklmnop1234567890",
" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~")
all(sapply(testStrings,test))
d = read.csv("~/Documents/Conferences/Evolang12/genderBias2018/data/E12.csv", stringsAsFactors = F)
head(d)
score = tapply(d$Score,d$Number,mean)
gender = tapply(d$FirstAuthGender,d$Number,mean)
library(ggplot2)
d2 = data.frame(
score = tapply(d$Score,d$Number,mean),
gender = tapply(d$FirstAuthGender,d$Number,mean)
)
dim(d2)
head(d2)
d$Fi
d2 = data.frame(
score = tapply(d$Score,d$Number,mean),
gender = tapply(d$FirstAuthGender,d$Number,head,n=1)
)
d = read.csv("~/Documents/Conferences/Evolang12/genderBias2018/data/E12.csv", stringsAsFactors = F)
d2 = data.frame(
score = tapply(d$Score,d$Number,mean),
gender = tapply(d$FirstAuthGender,d$Number,head,n=1)
)
library(ggplot2)
ggplot(d2,aes(x=gender,y=score)) + geom_violin()
t.test(d2$score~d2$gender)
ggplot(d2,aes(x=gender*status,y=score)) + geom_violin()
d2 = data.frame(
score = tapply(d$Score,d$Number,mean),
gender = tapply(d$FirstAuthGender,d$Number,head,n=1),
status = tapply(d$FirstAuthStatus,d$Number,head,n=1),
)
d2 = data.frame(
score = tapply(d$Score,d$Number,mean),
gender = tapply(d$FirstAuthGender,d$Number,head,n=1),
status = tapply(d$FirstAuthStatus,d$Number,head,n=1)
)
ggplot(d2,aes(x=gender*status,y=score)) + geom_violin()
ggplot(d2,aes(x=gender:status,y=score)) + geom_violin()
ggplot(d2,aes(x=status,y=score)) + geom_violin()
d2$genstatus = paste(d2$gender,d2$status)
ggplot(d2,aes(x=genstatus,y=score)) + geom_violin()
summary(lm(score~gender*status,data=d2))
summary(lm(score~gender+status,data=d2))
hist(d2$score)
d2$genstatus = paste(d2$status,d2$gender)
ggplot(d2,aes(x=genstatus,y=score)) + geom_violin()
ggplot(d2,aes(x=genstatus,y=score)) + geom_violin() + geom_boxplot()
head(d)
d = read.csv("~/Documents/Conferences/Evolang12/genderBias2018/data/E12.csv", stringsAsFactors = F)
d2 = data.frame(
score = tapply(d$Score,d$Number,mean),
gender = tapply(d$FirstAuthGender,d$Number,head,n=1),
status = tapply(d$FirstAuthStatus,d$Number,head,n=1),
SubmissionLength = tapply(d$SubmissionLength)
)
d2$genstatus = paste(d2$status,d2$gender)
library(ggplot2)
ggplot(d2,aes(x=genstatus,y=score)) + geom_violin() + geom_boxplot()
summary(lm(score~gender*status*SubmissionLength,data=d2))
d = read.csv("~/Documents/Conferences/Evolang12/genderBias2018/data/E12.csv", stringsAsFactors = F)
d2 = data.frame(
score = tapply(d$Score,d$Number,mean),
gender = tapply(d$FirstAuthGender,d$Number,head,n=1),
status = tapply(d$FirstAuthStatus,d$Number,head,n=1),
SubmissionLength = tapply(d$SubmissionLength,d$Number,head,n=1)
)
d2$genstatus = paste(d2$status,d2$gender)
library(ggplot2)
ggplot(d2,aes(x=genstatus,y=score)) + geom_violin() + geom_boxplot()
summary(lm(score~gender*status*SubmissionLength,data=d2))
summary(lm(score~gender*SubmissionLength,data=d2))
summary(lm(score~gender*status,data=d2))
d3 = read.table("/Users/sgroberts/Documents/MPI/refLexIron/LexDistances/Lesage/IronLingPy/IronWords2/Data/LingPyOutput/SWADESH_POST_lexstat.qlc", sep="\t",header=T,stringsAsFactors = F, fileEncoding = "UTF-8", encoding = "UTF-8",quote='',skip=7)
head(d3)
length(unique(d3$LEXSTATID))
dim(d3)
d2 = read.table("/Users/sgroberts/Documents/MPI/refLexIron/LexDistances/Lesage/IronLingPy/IronWords2/Data/qlc/Swadesh_lexstat.qlc", sep="\t",header=T,stringsAsFactors = F, fileEncoding = "UTF-8", encoding = "UTF-8", skip=81)
unqiue(unlist(strsplit(d2$TOKENS,"")))
unique(unlist(strsplit(d2$TOKENS,"")))
unique(unlist(strsplit(d2$TOKENS[d2$DOCULECT=="XX205"],"")))
a = d2[d2$DOCULECT=="XX205",]
b = d2[d2$DOCULECT=="luoXaa",]
head(a)
head(b)
unique(a$CONCEPT)
unique(b$CONCEPT)
x = intersect(a$CONCEPT,b$CONCEPT)
x
a[a$CONCEPT %in% x,][order(a$CONCEPT),]
a[a$CONCEPT %in% x,][order(a$CONCEPT),]$COUNTERPART
b[b$CONCEPT %in% x,][order(b$CONCEPT),]$COUNTERPART
d3 = read.table("/Users/sgroberts/Documents/MPI/refLexIron/LexDistances/Lesage/IronLingPy/IronWords2/Programs/Python/SWADESH_POST_lexstat_full.qlc", sep="\t",header=T,stringsAsFactors = F, fileEncoding = "UTF-8", encoding = "UTF-8",quote='',skip=7)
d3 = read.table("/Users/sgroberts/Documents/MPI/refLexIron/LexDistances/Lesage/IronLingPy/IronWords2/Programs/Python/SWADESH_POST_lexstat_full.qlc", sep="\t",header=T,stringsAsFactors = F, fileEncoding = "UTF-8", encoding = "UTF-8",quote='',skip=3)
length(unique(d3$DO))
length(unique(d3$LEXSTATID))
dim(d3)
n = 200
noise = 2
a = rnorm(n)
z = rnorm(n)
c = jitter(z,amount = noise)
b = jitter(c+a,amount = noise)
plot(z,c)
n = 200
noise = 2
a = rnorm(n)
z = rnorm(n)
c = jitter(z,amount = noise)
b = jitter(c+a,amount = noise)
plot(z,c)
summary(lm(c~z + a))
cor(z,c)
cor(a,c)
summary(lm(c~z + a))
n = 200
noise = 4
a = rnorm(n)
z = rnorm(n)
c = jitter(z,amount = noise)
b = jitter(c+a,amount = noise)
plot(z,c)
cor(z,c)
cor(a,c)
summary(lm(c~z + a))
summary(lm(c~z + a + b))
summary(lm(c~z + a))
cor(z,c)
cor(a,c)
plot(z,c)
summary(lm(c~z + a))
summary(lm(c~z + a + b))
m0 = lm(X ~ Y)
summary(m0)
m1 = lm(X ~ Y + A)
summary(m1)
m2 = lm(X ~ Y + A + B)
summary(m2)
m3 = lm(X ~ Y + A + B + C)
summary(m3)
n=200
err = 2
A = rnorm(n)
C = rnorm(n)
B = jitter(A + C,amount=err)
X = jitter(A + B,amount=err)
Y = jitter(X + C,amount=err)
m0 = lm(X ~ Y)
summary(m0)
m1 = lm(X ~ Y + A)
summary(m1)
m2 = lm(X ~ Y + A + B)
summary(m2)
m3 = lm(X ~ Y + A + B + C)
summary(m3)
n=200
err = 5
A = rnorm(n)
C = rnorm(n)
B = jitter(A + C,amount=err)
X = jitter(A + B,amount=err)
Y = jitter(X + C,amount=err)
m0 = lm(X ~ Y)
summary(m0)
m1 = lm(X ~ Y + A)
summary(m1)
m2 = lm(X ~ Y + A + B)
summary(m2)
m3 = lm(X ~ Y + A + B + C)
summary(m3)
n=200
err = 10
A = rnorm(n)
C = rnorm(n)
B = jitter(A + C,amount=err)
X = jitter(A + B,amount=err)
Y = jitter(X + C,amount=err)
m0 = lm(X ~ Y)
summary(m0)
m1 = lm(X ~ Y + A)
summary(m1)
m2 = lm(X ~ Y + A + B)
summary(m2)
m3 = lm(X ~ Y + A + B + C)
summary(m3)
m3 = lm(X ~ Y + C)
summary(m3)
summary(m1)
summary(m3)
m3 = lm(X ~ Y + A + B + C)
summary(m3)
m4 = lm(X ~ Y + C)
summary(m4)
n=200
err = 10
A = rnorm(n)
C = rnorm(n)
B = jitter(A + C,amount=err)
X = jitter(A + B,amount=err)
Y = jitter(X + C,amount=err)
m0 = lm(X ~ Y)
summary(m0)
m1 = lm(X ~ Y + B)
summary(m1)
n=200
err = 10
A = rnorm(n)
C = rnorm(n)
B = jitter(A + C,amount=err)
X = jitter(A + B,amount=err)
Y = jitter((0.35*X) + (0.65*C),amount=err)
m0 = lm(X ~ Y)
summary(m0)
m1 = lm(X ~ Y + B)
summary(m1)
m2 = lm(X ~ Y + A + B)
summary(m2)
m3 = lm(X ~ Y + A + B + C)
summary(m3)
m4 = lm(X ~ Y + C)
summary(m4)
m0 = lm(X ~ Y)
summary(m0)
m1 = lm(X ~ Y + B)
summary(m1)
m4 = lm(X ~ Y + C)
summary(m4)
n=1000
err = 10
A = rnorm(n)
C = rnorm(n)
B = jitter(A + C,amount=err)
X = jitter(A + B,amount=err)
Y = jitter((0.35*X) + (0.65*C),amount=err)
m0 = lm(X ~ Y)
summary(m0)
m1 = lm(X ~ Y + B)
summary(m1)
m2 = lm(X ~ Y + A + B)
summary(m2)
m3 = lm(X ~ Y + A + B + C)
summary(m3)
m4 = lm(X ~ Y + C)
summary(m4)
hist(X)
hist(Y)
hist(Z)
hist(A)
hist(B)
hist(C)
hist(Y)
mean(Y)
summary(m4)
m4 = lm(X ~ 0 + Y + C)
summary(m4)
m0 = lm(X ~ 0 + Y)
summary(m0)
m1 = lm(X ~ 0 + Y + B)
summary(m1)
m2 = lm(X ~ 0 + Y + A + B)
summary(m2)
cor(X,Y)
cor(X,Y)
n=1000
err = 10
A = rnorm(n) + 10
C = rnorm(n) + 10
B = jitter(A + C,amount=err)
X = jitter(A + B,amount=err)
Y = jitter((0.35*X) + (0.65*C),amount=err)
m0 = lm(X ~ Y)
summary(m0)
m1 = lm(X ~ Y + B)
summary(m1)
m2 = lm(X ~ Y + A + B)
summary(m2)
m3 = lm(X ~ Y + A + B + C)
summary(m3)
m4 = lm(X ~ Y + C)
summary(m4)
cor(X,Y)
m1 = lm(X ~ Y + B)
summary(m1)
m2 = lm(X ~ Y + A + B)
summary(m2)
m3 = lm(X ~ Y + A + B + C)
summary(m3)
m4 = lm(X ~ Y + C)
summary(m4)
library(haven)
library(brms)
setwd("~/Documents/Bristol/FTRAccounting/FTRAccountingStudy/analysis/")
# Curcd: ISO currency code
# Fic: Current ISO country code – country of incorporation
# Loc: Current ISO country code – headquarters
# Country: Country ID from IBES (Thompson Reuters). This database includes financial analysts forecasts information. I attach the table from IBES manual that details the country codes used.
d = read_dta("../data/ftrdataset July 5 2017.dta")
l = read.csv("../data/langftr.csv",
stringsAsFactors = F,encoding = "UTF-8",
fileEncoding = 'UTF-8')
l$genus = gsub(" +$","",l$genus)
l$genus2 = gsub(" +$","",l$genus2)
l$genus3 = gsub(" +$","",l$genus3)
l$genus[l$genus==""] = " None"
l$genus2[l$genus2==""] = " None"
l$genus3[l$genus3==""] = " None"
allGenus = unique(c(l$genus,l$genus2,l$genus3))
allGenus = sort(allGenus)
allGenus.code = 0:length(allGenus)
names(allGenus.code)= allGenus
l$G1 = allGenus.code[l$genus]
l$G2 = allGenus.code[l$genus2]
l$G3 = allGenus.code[l$genus3]
l$G1[is.na(l$G1)] = 0
l$G2[is.na(l$G1)] = 0
l$G3[is.na(l$G1)] = 0
# weights (balanced, but zero if genus is ' None')
l$G1.p = 1/apply(l[,c("G1","G2","G3")],1,function(X){sum(X>0)})
l$G2.p = 1/apply(l[,c("G1","G2","G3")],1,function(X){sum(X>0)})
l$G3.p = 1/apply(l[,c("G1","G2","G3")],1,function(X){sum(X>0)})
d$G1 = l[match(d$loc,l$loc),]$G1
d$G2 = l[match(d$loc,l$loc),]$G2
d$G3 = l[match(d$loc,l$loc),]$G3
d$G1.p = l[match(d$loc,l$loc),]$G1.p
d$G2.p = l[match(d$loc,l$loc),]$G2.p
d$G3.p = l[match(d$loc,l$loc),]$G3.p
d = d[sample(1:nrow(d),2000),]
summary(lm(AAM~ 1 + pcftr, data=d))
fit_mm <-
brm(AAM ~ 1 + pcftr +
(1 | mm(G1, G2, G3, # langs
weights = cbind(G1.p, G2.p, G3.p))),
data   = d,
warmup = 50,
iter   = 100)
plot(fit_mm)
stanplot((fit_mm))
summary(fit_mm)
summary(lm(AAM~ 1 + pcftr, data=d))
library(vegan)
vegan::mantel()
?vegan::mantel.partial
library(ecodist)
?ecodist::mantel.partial
?ecodist::mantel
??rfci
??krfci
